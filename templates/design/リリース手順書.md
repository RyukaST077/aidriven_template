# リリース手順書

**リリース対象バージョン**: v1.0.0
**リリース予定日時**: 202x/MM/DD 10:00 - 12:00
**作業責任者**: 名前

## 1. リリース概要
### 1.1 リリース内容
* 新機能「〇〇」の追加
* バグFix（Issue #123, #124）

### 1.2 影響範囲・停止時間
* **サービス停止**: あり / なし
* **停止時間**: 10:00 - 11:00 (60分)
* **影響**: メンテナンス画面を表示し、全機能利用不可

## 2. 事前確認・準備 (T-1 day)
| No | 項目 | 手順 | 確認者 | 判定 |
| -- | -- | -- | -- | -- |
| 1 | バックアップ確認 | 前日分のバックアップが正常に取得できているか確認 | | □OK |
| 2 | 資材準備 | リリース用DockerイメージがRegistryにPushされているか確認 (Tags: v1.0.0) | | □OK |
| 3 | 通知 | 関係者・ユーザーへの事前通知が完了しているか確認 | | □OK |

## 3. リリース当日の手順 (T-0)
| No | 時間 | 作業項目 | 手順・コマンド | 担当 | Check |
| -- | -- | -- | -- | -- | -- |
| 1 | 10:00 | メンテ入り | ロードバランサーでメンテナンス画面へ切り替え | | □ |
| 2 | 10:05 | DBマイグレーション | `npm run db:migrate` <br> エラーがないことをログで確認 | | □ |
| 3 | 10:15 | アプリデプロイ | `kubectl apply -f deployment.yaml` <br> Podsが全てRunningになることを確認 | | □ |
| 4 | 10:30 | 動作確認 | 動作確認項目書（別紙）に従い、正常性を確認 | | □ |
| 5 | 10:55 | メンテ明け | ロードバランサーの切替を戻す | | □ |
| 6 | 11:00 | 一般公開確認 | 外部からのアクセス疎通確認 | | □ |

## 4. 切り戻し手順 (Rollback)
リリース作業中に重大な問題が発生し、解決の目途が立たない場合は切り戻しを行う。

**判断基準**: 10:45までにデプロイが完了しない、または致命的なバグが見つかった場合。

| No | 手順 | コマンドなど |
| -- | -- | -- |
| 1 | アプリ切り戻し | `kubectl rollback deployment/app` (前バージョンへRevert) |
| 2 | DB切り戻し | `npm run db:migrate:undo` (必要であればバックアップからリストア) |
| 3 | 確認 | 前バージョンで正常稼働することを確認 |

## 5. 連絡網
システム障害発生時の緊急連絡先。
