# 画面設計書

## 0. ドキュメント情報
| 項目 | 内容 |
| -- | -- |
| システム名 | [System Name] |
| 対象範囲 | [画面一覧] |
| バージョン | 1.0 |
| 作成日 | YYYY-MM-DD |
| 作成者 | [Name] |
| 承認者 | [Name] |

## 1. 画面一覧
| 画面ID | 画面名称 | 概要 | 権限 | URLパス | 備考 |
| -- | -- | -- | -- | -- | -- |
| S001 | ログイン画面 | ユーザー認証を行う | 全員 | `/login` | |
| S002 | ダッシュボード | 概要情報を表示する | ログインユーザー | `/dashboard` | |
| S003 | 商品一覧画面 | 商品の一覧を表示 | 全員 | `/products` | |
| S004 | 商品詳細画面 | 商品の詳細情報を表示 | 全員 | `/products/:id` | |
| S005 | 商品編集画面 | 商品情報を編集 | 管理者 | `/products/:id/edit` | |
| S006 | 注文履歴画面 | ユーザーの注文履歴を表示 | ログインユーザー | `/orders` | |
| S007 | 注文詳細画面 | 注文の詳細情報を表示 | ログインユーザー | `/orders/:id` | |
| S008 | カート画面 | 購入する商品を管理 | 全員 | `/cart` | |
| S009 | 注文確認画面 | 注文内容を確認 | ログインユーザー | `/checkout` | |
| S010 | ユーザー設定画面 | プロフィール情報を編集 | ログインユーザー | `/settings` | |

### 1.1 権限マトリクス
| 画面ID | 画面名称 | ゲスト | 一般ユーザー | 管理者 | 備考 |
| -- | -- | -- | -- | -- | -- |
| S001 | ログイン画面 | ✓ | ✓ | ✓ | ログイン済みはリダイレクト |
| S002 | ダッシュボード | ✕ | ✓ | ✓ | |
| S003 | 商品一覧画面 | ✓ | ✓ | ✓ | |
| S004 | 商品詳細画面 | ✓ | ✓ | ✓ | |
| S005 | 商品編集画面 | ✕ | ✕ | ✓ | 403 Forbidden表示 |
| S006 | 注文履歴画面 | ✕ | ✓ | ✓ | 自分の注文のみ表示 |
| S007 | 注文詳細画面 | ✕ | ✓ | ✓ | 自分の注文のみ表示 |
| S008 | カート画面 | ✓ | ✓ | ✓ | ゲストカート対応 |
| S009 | 注文確認画面 | ✕ | ✓ | ✓ | ログイン必須 |
| S010 | ユーザー設定画面 | ✕ | ✓ | ✓ | |

## 2. 画面遷移図
```mermaid
graph TB
    Start([TOPページ]) --> Login[S001:ログイン]
    Start --> Products[S003:商品一覧]

    Login -->|成功| Dashboard[S002:ダッシュボード]
    Dashboard --> Products
    Dashboard --> Orders[S006:注文履歴]
    Dashboard --> Settings[S010:設定]

    Products --> Detail[S004:商品詳細]
    Detail --> Cart[S008:カート]
    Detail -->|管理者| Edit[S005:商品編集]

    Cart --> Checkout[S009:注文確認]
    Checkout -->|注文完了| OrderDetail[S007:注文詳細]

    Orders --> OrderDetail
```

## 3. 共通仕様
### 3.1 ヘッダー・フッター
**ヘッダー構成**:
- ロゴ（左上、クリックでTOPへ）
- グローバルナビゲーション：商品一覧、カート、マイページ
- 検索ボックス（中央）
- ユーザーメニュー（右上）：プロフィール、設定、ログアウト
- カートアイコン（バッジ：商品数表示）

**フッター構成**:
- 企業情報リンク
- 利用規約、プライバシーポリシー
- SNSリンク
- 著作権表示

### 3.2 共通エラーメッセージ
#### 3.2.1 エラー表示方式
- **トースト通知**: 画面右上から3秒間表示（自動消去）
- **インラインアラート**: フォーム直上に表示（手動で閉じる）
- **フィールドエラー**: 入力欄下に赤文字で表示

#### 3.2.2 エラーメッセージ一覧
| エラーコード | メッセージ | 表示方式 | 発生タイミング |
| -- | -- | -- | -- |
| E001 | 入力内容に誤りがあります | インライン | バリデーションエラー |
| E002 | ログインに失敗しました。メールアドレスまたはパスワードが正しくありません | トースト | 認証失敗 |
| E003 | セッションが期限切れです。再度ログインしてください | トースト | セッションタイムアウト |
| E004 | この操作を実行する権限がありません | インライン | 認可エラー |
| E005 | データが見つかりませんでした | インライン | 404 Not Found |
| E006 | 一時的なエラーが発生しました。しばらくしてから再度お試しください | トースト | サーバーエラー |
| E007 | ネットワークエラーが発生しました。接続を確認してください | トースト | ネットワーク障害 |
| E008 | 在庫が不足しています | インライン | 在庫不足 |

### 3.3 ページネーション・ソート・フィルタ
**ページネーション**:
- デフォルト: 20件/ページ
- 表示件数変更: 10/20/50/100件
- ページャー位置: 一覧下部および上部
- 無限スクロールは不採用（SEO対策）

**ソート**:
- デフォルト: 作成日時降順
- カラムヘッダークリックでソート切り替え
- 矢印アイコンで昇順・降順表示

**フィルタ**:
- 検索ボックス: リアルタイム検索（300msのデバウンス）
- 適用中フィルターをバッジ表示（削除可能）

### 3.4 アクセシビリティ・レスポンシブ方針
- **アクセシビリティ**: WCAG 2.1 AA準拠（コントラスト比4.5:1以上）
- **レスポンシブ**: PC (>1024px) / Tablet / Mobile (<768px)

### 3.5 インタラクション状態 (States)
- **Default**: 初期表示
- **Loading**: データ取得中（スケルトン推奨）
- **Empty**: データ0件の表示とアクション
- **Error**: エラー時のトースト/インライン

### 3.6 セキュリティ対策
- **入力値のサニタイズ**: DOMPurify + サーバー再バリデーション
- **XSS対策**: CSP、`dangerouslySetInnerHTML`禁止
- **CSRF対策**: SameSite Cookie + トークン検証
- **クリックジャッキング対策**: X-Frame-Options: DENY

### 3.7 キーボードショートカット
| キー操作 | 機能 | 対象画面 |
| -- | -- | -- |
| `/` | 検索ボックスにフォーカス | 全画面 |
| `Esc` | モーダル/ドロワーを閉じる | 全画面 |
| `Ctrl + K` | コマンドパレット表示 | 全画面 |
| `Tab` | 次の要素にフォーカス | 全画面 |
| `Shift + Tab` | 前の要素にフォーカス | 全画面 |
| `Enter` | フォーム送信 / ボタン実行 | 入力フォーム |
| `← →` | ページネーション | 一覧画面 |

### 3.8 多言語対応 (i18n)
- 初期フェーズ: 日本語のみ
- 将来対応: 英語、中国語（簡体）
- ライブラリ: `react-i18next`

### 3.9 パフォーマンス指標
| 指標 | 目標 | 計測方法 |
| -- | -- | -- |
| FCP | 1.5秒以内 | Lighthouse |
| LCP | 2.5秒以内 | Lighthouse |
| TTI | 3.5秒以内 | Lighthouse |
| CLS | 0.1以下 | Lighthouse |
| TBT | 300ms以下 | Lighthouse |

### 3.10 デザインシステム
- **コンポーネントライブラリ**: Material-UI (MUI) v5
- **フォント**: Noto Sans JP
- **スペーシング**: 8pxベース
- **Storybook**でコンポーネント管理

## 4. 画面詳細テンプレート（必須記入）
各画面ごとに以下の項目を必ず記入すること。
- レイアウト/ワイヤー
- 入力項目
- API（エンドポイント/リクエスト/レスポンス）
- バリデーション
- 権限/遷移
- 状態（Loading/Empty/Error）
- 監査/トラッキングイベント
- アクセシビリティ考慮

## 5. 画面詳細定義
### 5.1 [S001] ログイン画面
#### 5.1.1 画面レイアウト概要
- ロゴ画像（中央上）
- メールアドレス入力欄
- パスワード入力欄
- ログインボタン
- パスワード忘れリンク

#### 5.1.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | メールアドレス | Text | 〇 | なし | RFC準拠、最大255文字 | |
| 2 | パスワード | Password | 〇 | なし | 8文字以上、128文字以下 | |
| 3 | ログイン | Button | - | - | クリックで認証処理 | |

#### 5.1.3 API定義
- **POST** `/api/auth/login`
- **Request**: `{ email, password }`
- **Response**: `{ access_token, refresh_token, user }`

#### 5.1.4 イベント・アクション定義
| イベント | トリガー | 処理概要 | 遷移先 |
| -- | -- | -- | -- |
| ログイン押下 | Click | 認証API呼び出し | 成功: ダッシュボード / 失敗: 自画面 |

#### 5.1.5 セキュリティ
- 連続失敗時ロックアウト（例: 5回/10分）
- CAPTCHA（ボット対策）

---
### 5.2 [S002] ダッシュボード
#### 5.2.1 画面レイアウト概要
- [記入]

#### 5.2.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.2.3 API定義
- **Method**: [GET/POST]
- **Path**: [TBD]
- **Request**: [TBD]
- **Response**: [TBD]

#### 5.2.4 イベント・アクション定義
| イベント | トリガー | 処理概要 | 遷移先 |
| -- | -- | -- | -- |
| [記入] | [記入] | [記入] | [記入] |

#### 5.2.5 状態/権限
- **Loading**: [記入]
- **Empty**: [記入]
- **Error**: [記入]
- **権限制御**: [記入]

---
### 5.3 [S003] 商品一覧画面
#### 5.3.1 画面レイアウト概要
- [記入]

#### 5.3.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.3.3 API定義
- **Method**: [GET]
- **Path**: [TBD]
- **Query**: [TBD]
- **Response**: [TBD]

#### 5.3.4 フィルタ/ソート
- [記入]

#### 5.3.5 状態/権限
- **Loading**: [記入]
- **Empty**: [記入]
- **Error**: [記入]
- **権限制御**: [記入]

---
### 5.4 [S004] 商品詳細画面
#### 5.4.1 画面レイアウト概要
- [記入]

#### 5.4.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.4.3 API定義
- **Method**: [GET]
- **Path**: [TBD]
- **Response**: [TBD]

#### 5.4.4 状態/権限
- **Loading**: [記入]
- **Empty**: [記入]
- **Error**: [記入]
- **権限制御**: [記入]

---
### 5.5 [S005] 商品編集画面
#### 5.5.1 画面レイアウト概要
- [記入]

#### 5.5.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.5.3 API定義
- **Method**: [PUT/PATCH]
- **Path**: [TBD]
- **Request**: [TBD]
- **Response**: [TBD]

#### 5.5.4 状態/権限
- **Loading**: [記入]
- **Error**: [記入]
- **権限制御**: 管理者のみ

---
### 5.6 [S006] 注文履歴画面
#### 5.6.1 画面レイアウト概要
- [記入]

#### 5.6.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.6.3 API定義
- **Method**: [GET]
- **Path**: [TBD]
- **Query**: [TBD]
- **Response**: [TBD]

#### 5.6.4 状態/権限
- **Loading**: [記入]
- **Empty**: [記入]
- **Error**: [記入]
- **権限制御**: [記入]

---
### 5.7 [S007] 注文詳細画面
#### 5.7.1 画面レイアウト概要
- [記入]

#### 5.7.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.7.3 API定義
- **Method**: [GET]
- **Path**: [TBD]
- **Response**: [TBD]

#### 5.7.4 状態/権限
- **Loading**: [記入]
- **Empty**: [記入]
- **Error**: [記入]
- **権限制御**: [記入]

---
### 5.8 [S008] カート画面
#### 5.8.1 画面レイアウト概要
- [記入]

#### 5.8.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.8.3 API定義
- **Method**: [GET/POST]
- **Path**: [TBD]
- **Request**: [TBD]
- **Response**: [TBD]

#### 5.8.4 状態/権限
- **Loading**: [記入]
- **Empty**: [記入]
- **Error**: [記入]
- **権限制御**: [記入]

---
### 5.9 [S009] 注文確認画面
#### 5.9.1 画面レイアウト概要
- [記入]

#### 5.9.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.9.3 API定義
- **Method**: [POST]
- **Path**: [TBD]
- **Request**: [TBD]
- **Response**: [TBD]

#### 5.9.4 状態/権限
- **Loading**: [記入]
- **Error**: [記入]
- **権限制御**: [記入]

---
### 5.10 [S010] ユーザー設定画面
#### 5.10.1 画面レイアウト概要
- [記入]

#### 5.10.2 画面項目定義
| No | 項目名 | 形式 | 必須 | 初期値 | 入力規則・バリデーション | 備考 |
| -- | -- | -- | -- | -- | -- | -- |
| 1 | [記入] | [記入] | [記入] | [記入] | [記入] | [記入] |

#### 5.10.3 API定義
- **Method**: [GET/PUT]
- **Path**: [TBD]
- **Request**: [TBD]
- **Response**: [TBD]

#### 5.10.4 状態/権限
- **Loading**: [記入]
- **Error**: [記入]
- **権限制御**: [記入]

---

## 改訂履歴
| バージョン | 日付 | 変更内容 | 承認者 |
| -- | -- | -- | -- |
| 1.0 | 2026-01-08 | 初版作成 | - |
