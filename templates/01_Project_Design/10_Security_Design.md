# セキュリティ設計書

## 1. セキュリティ基本方針
本システムは、**OWASP ASVS (Application Security Verification Standard) Level 2** への準拠を目標とする。
また、情報セキュリティの3要素（機密性・完全性・可用性）を確保するための設計を行う。

## 2. 脅威モデリング (Threat Modeling)
### 2.1 STRIDE分析
重要なデータフローに対してSTRIDE手法を用いた脅威分析を行う。
* **S (Spoofing)**: なりすまし -> 厳格な認証
* **T (Tampering)**: 改ざん -> デジタル署名、整合性チェック
* **R (Repudiation)**: 否認 -> 監査ログの保全
* **I (Information Disclosure)**: 情報漏洩 -> 暗号化、アクセス制御
* **D (Denial of Service)**: サービス拒否 -> レート制限、WAF
* **E (Elevation of Privilege)**: 権限昇格 -> 最小権限の原則

## 3. 認証・認可設計 (ASVS V2, V3)
* **方式**: OpenID Connect / Email & Password
* **パスワードポリシー**: 
    - 長さ: 10文字以上
    - 文字種: 英大文字・小文字・数字・記号の混在必須
    - 有効期限: 90日
* **多要素認証 (MFA)**: 管理者権限を持つユーザーは必須とする。

### 2.2 認可 (Authorization)
* **ロールベースアクセス制御 (RBAC)**
| ロール | 権限概要 |
| -- | -- |
| Admin | 全機能の利用、ユーザー管理が可能 |
| Member | 自身のデータ閲覧・編集が可能 |
| Guest | 公開情報の閲覧のみ |

## 3. データ保護設計
### 3.1 通信の暗号化
* インターネット経由の通信は全てTLS 1.2以上を使用する。
* 内部ネットワーク間も可能な限り暗号化する。

### 3.2 保存データの暗号化
* データベース: EBS暗号化 / TDE (Transparent Data Encryption) を使用。
* 機密情報: パスワードはbcrypt/Argon2でハッシュ化。APIキーなどはAES-256で暗号化して保存。

## 4. 脆弱性対策
### 4.1 アプリケーション脆弱性
* SQLインジェクション対策: プレースホルダ/ORMの使用。
* XSS対策: フレームワークのサニタイズ機能利用、CSPヘッダーの設定。
* CSRF対策: CSRFトークンの利用。

## 5. 監査ログ・監視
* **監査ログ**: 「誰が」「いつ」「何をしたか」を記録する。
    - ログイン成功/失敗
    - 重要データの変更・削除
* **ログ保存期間**: 3年間保管（コンプライアンス要件）。
